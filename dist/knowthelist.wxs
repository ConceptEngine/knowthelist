<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
    <Product Id="EBF31208-1D91-4E9A-9842-FF9B5A7D7206" Name="Knowthelist" Language="1033" Version="2.2.3" Manufacturer="Knowthelist-org" UpgradeCode="A0C2847E-FD44-4A43-A9FD-015230A3C450">
        <Package Description="The awesome party music player" Comments="Knowthelist" InstallerVersion="200" Compressed="yes" />
        <Media Id="1" Cabinet="knowthelist.cab" EmbedCab="yes" />
        <WixVariable Id="WixUILicenseRtf" Value="License.rtf" />
	<WixVariable Id="WixUIExclamationIco" Value="headset.ico" />
	<WixVariable Id="WixUIBannerBmp" Value="banner.bmp" />
	<WixVariable Id="WixUIDialogBmp" Value="dialog.bmp" />
        <CustomAction Id="SetGstPath" Property="GST_BIN" Value="[%GSTREAMER_1_0_ROOT_X86]bin" />
        <CustomAction Id="SetGstLibPath" Property="GST_LIBS" Value="[%GSTREAMER_1_0_ROOT_X86]lib\gstreamer-1.0" />
        <InstallExecuteSequence>
            <Custom Action="SetGstPath" Before="InstallInitialize" />
	    <Custom Action="SetGstLibPath" Before="InstallInitialize" />
        </InstallExecuteSequence>
        <Icon Id="ICON_ICO" SourceFile="headset.ico" />
        <Property Id="ARPPRODUCTICON" Value="ICON_ICO" />
        <Property Id="SOURCE_PATH" Value="..\..\build-knowthelist-MinGW_Static_32bit-Release" />
        <Condition Message="No GStreamer installation found. Please install GStreamer(x86) v1.4 or higher from http://gstreamer.freedesktop.org first and try it again."><![CDATA[%GSTREAMER_1_0_ROOT_X86 <> ""]]></Condition>
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder" Name="PFiles">
                <Directory Id="KNOWTHELIST_ORG" Name="knowthelist-org">
                    <Component Id="KNOWTHELIST.EXE" DiskId="1" Guid="0B3C8076-532A-4AD1-8F1E-FECF3549ECBD">
                        <File Id="KNOWTHELIST.EXE" Name="knowthelist.exe" Source="..\..\build-knowthelist-MinGW_Static_32bit-Release\knowthelist.exe">
                            <Shortcut Id="desktopShortcut" Directory="DesktopFolder" Name="Knowthelist" WorkingDirectory="INSTALLDIR" Advertise="yes" Icon="DesktopIcon.exe" IconIndex="0" />
                            <Shortcut Id="ExeShortcut" Directory="ProgramMenuDir" Name="Knowthelist" Advertise="yes" Icon="StartMenuIcon.exe" IconIndex="0" />
                        </File>
                        <File Id="SINK.DLL" Name="libgstdirectsoundsink.dll" Source="..\..\build-knowthelist-MinGW_Static_32bit-Release\libgstdirectsoundsink.dll" />
                        <RemoveFile Id="PurgeAppFolder" Name="*.*" On="uninstall" />
                    </Component>
                </Directory>
            </Directory>
            <Directory Id="DesktopFolder" />
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ProgramMenuDir" Name="Knowthelist-org">
                    <Component Id="StartMenuShortcuts" Guid="A57B7DF4-B1A4-4871-820B-4847C0AB9E09">
                        <RemoveFolder Id="ProgramMenuDir" On="uninstall" />
                        <RegistryValue Root="HKCU" Key="Software\knowthelist-org\knowthelist" Type="string" Value="" />
                        <Shortcut Id="UninstallProduct" Name="Uninstall" Description="Uninstalls the application" Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" />
                        <util:InternetShortcut Id="WebsiteShortcut" Name="Knowthelist Homepage" Target="http://knowthelist.github.io/knowthelist" />
                    </Component>
                </Directory>
            </Directory>
        </Directory>
        <Feature Id="DefaultFeature" Title="Main Feature" Level="1">
            <ComponentRef Id="KNOWTHELIST.EXE" />
            <ComponentRef Id="StartMenuShortcuts" />
        </Feature>
        <Feature Id="CopyFeature" Title="Main Feature" Level="1">
            <Component Id="CopyGstLibs1" Guid="" Directory="KNOWTHELIST_ORG">
                <CopyFile Id="CopyGstLibs" SourceProperty="GST_BIN" SourceName="*.dll" DestinationProperty="KNOWTHELIST_ORG" />
                <CopyFile Id="MoveSink" SourceProperty="KNOWTHELIST_ORG" SourceName="libgstdirectsoundsink.dll" DestinationProperty="GST_LIBS" Delete="yes" />
            </Component>
        </Feature>
        <UI />
        <Icon Id="DesktopIcon.exe" SourceFile="..\..\build-knowthelist-MinGW_Static_32bit-Release\knowthelist.exe" />
        <Icon Id="StartMenuIcon.exe" SourceFile="..\..\build-knowthelist-MinGW_Static_32bit-Release\knowthelist.exe" />
        <UIRef Id="WixUI_Mondo" />
    </Product>
</Wix>